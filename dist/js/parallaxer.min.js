(function(){function e(e){var t={},n=[];e=e||this,e.on=function(e,n,o){(t[e]=t[e]||[]).push([n,o])},e.off=function(e,o){e||(t={});for(var i=t[e]||n,a=i.length=o?i.length:0;a--;)o==i[a][0]&&i.splice(a,1)},e.emit=function(e){for(var o,i=t[e]||n,a=0;o=i[a++];)o[0].apply(o[1],n.slice.call(arguments,1))}}function t(t,o,i){function r(){for(var e,i,a=0;a<o.length;a++)e=o[a],i=new n(a,e.getAttribute("data-img-src")),g.push(i);t.appendChild(m)}function s(e){g.shift(),x=p.push(e),v===!0&&(g.length>0?g[0].load(s):h.emit("loaded"))}function l(e,t){var n=a.cover(e.width,e.height,y,E),o=t*T+X,i=T,r=n.sw/n.dw;o>=y||(0>o?(i+=o,o=0):o+i>=y&&(i=y-o),n.sx+=o*r,n.sw=i*r,n.dx=o,n.dw=i,w.drawImage(e,n.sx,n.sy,n.sw,n.sh,n.dx,n.dy,n.dw,n.dh))}function u(){v!==!0&&(v=!0,g.length>0&&g[0].load(s))}function c(){v===!0&&(v=!1)}function d(e,t){y=e,E=t,T=Math.ceil(y/i.numItemsPerSlides),m.width=y,m.height=E,w.clearRect(0,0,y,E)}function f(e){X=e,w.clearRect(0,0,y,E);for(var t,n=Math.floor(Math.abs(X/T)),o=Math.min(n+i.numItemsPerSlides+1,x);o>n;n++)t=p[n],l(t.getCanvas(),n)}var h=this,m=document.createElement("canvas"),w=m.getContext("2d"),v=!1,g=[],p=[],x=0,y=0,E=0,T=0,X=0;new e(this),r(),this.start=u,this.stop=c,this.resize=d,this.scrollTo=f}function n(e,t){function n(){u=new Image,u.onload=o}function o(){a=document.createElement("canvas"),r=a.getContext("2d"),setTimeout(function(){a.width=u.width,a.height=u.height,r.drawImage(u,0,0),s(l)},100)}function i(e){s=e,u.src=l.src}this.index=e,this.src=t;var a,r,s,l=this,u=new Image;n(),this.getCanvas=function(){return a},this.load=i}function o(t,n){function o(){T=i(["transform","msTransform","webkitTransform","mozTransform","oTransform"]),v.style.width=p/n.numItemsPerSlides*100+"%"}function i(e){for(var t=0;t<e.length;t++)if("undefined"!=typeof document.body.style[e[t]])return e[t];return null}function a(e){e.preventDefault()}function s(e){M+=e.deltaX,-X>M?M=-X:M>0&&(M=0)}function l(){y===!0&&(E=window.requestAnimationFrame(l),A+=(M-A)*x,v.style[T]="translate("+A+"px, 0px)",w.emit("move",A))}function u(e){X=v.offsetWidth-e,r.options({keyStep:Math.ceil(e/n.numItemsPerSlides),firefoxMult:120}),s({deltaX:0})}function c(e){M=e,-X>M?M=-X:M>0&&(M=0)}function d(){y!==!0&&(document.addEventListener("touchmove",a),r.on(s),y=!0,E=window.requestAnimationFrame(l))}function f(){y===!0&&(E&&(window.cancelAnimationFrame(E),E=null),y=!1,document.removeEventListener("touchmove",a),r.off(s))}function h(){M=A=0,v.style[T]="translate("+A+"px, 0px)"}function m(){y===!0&&f(),v=null,g=null,p=null,x=null,y=null,E=null,T=null,X=null,M=null,A=null,w=null}var w=this,v=t,g=v.querySelectorAll(".parallaxer--scroller--item"),p=g.length,x=n.ease,y=!1,E=null,T=null,X=0,M=0,A=0;new e(this),o(),this.getCurrentX=function(){return A},this.getItems=function(){return g},this.destroy=m,this.resize=u,this.scrollTo=c,this.start=d,this.stop=f,this.reset=h}function i(e,n){function i(){e.classList.add("parallaxer"),d=new o(e.querySelector("#parallaxer-scroller"),h),c=new t(e.querySelector("#parallaxer-bg"),d.getItems(),h),d.on("move",c.scrollTo)}function a(){}function r(){m!==!0&&(m=!0,w=e.clientWidth,v=e.clientHeight,d.resize(w),c.resize(w,v),d.start(),c.start())}function s(){m===!0&&(m=!1,d.stop(),c.stop())}function l(){}function u(){}var c,d,f={numItemsPerSlides:3,ease:.1},h=Object.assign({},f,n),m=!1,w=0,v=0;i(),this.scrollTo=a,this.start=r,this.stop=s,this.reset=l,this.destroy=u}var a=function(){return{cover:function(e,t,n,o,i,a){i="number"==typeof i?i:.5,a="number"==typeof a?a:.5,0>i&&(i=0),0>a&&(a=0),i>1&&(ffsetX=1),a>1&&(a=1);var r,s,l,u,c=e,d=t,f=Math.min(n/c,o/d),h=c*f,m=d*f,w=1;return n>h&&(w=n/h),o>m&&(w=o/m),h*=w,m*=w,l=c/(h/n),u=d/(m/o),r=(c-l)*i,s=(d-u)*a,0>r&&(r=0),0>s&&(s=0),l>c&&(l=c),u>d&&(u=d),{ratio:w,sx:r,sy:s,sw:l,sh:u,dx:0,dy:0,dw:n,dh:o}}}}();!function(){"use strict";var e,t=0,n=["ms","moz","webkit","o"];for(e=0;e<n.length&&!window.requestAnimationFrame;++e)window.requestAnimationFrame=window[n[e]+"RequestAnimationFrame"],window.cancelAnimationFrame=window[n[e]+"CancelAnimationFrame"]||window[n[e]+"CancelRequestAnimationFrame"];window.requestAnimationFrame||(window.requestAnimationFrame=function(e,n){var o=(new Date).getTime(),i=Math.max(0,16-(o-t)),a=window.setTimeout(function(){e(o+i)},i);return t=o+i,a}),window.cancelAnimationFrame||(window.cancelAnimationFrame=function(e){window.clearTimeout(e)})}();var r=function(e){var t,n,o,i,a={},r=[],s=!1,l=2,u=15,c=120,d=1,f="onwheel"in e,h="onmousewheel"in e,m="ontouchstart"in e,w=navigator.msMaxTouchPoints&&navigator.msMaxTouchPoints>1,v=!!window.navigator.msPointerEnabled,g="onkeydown"in e,p=navigator.userAgent.indexOf("Firefox")>-1,x={y:0,x:0,deltaX:0,deltaY:0,originalEvent:null};a.on=function(e){s||L(),r.push(e),t=r.length},a.options=function(e){c=e.keyStep||120,u=e.firefoxMult||15,l=e.touchMult||2,d=e.mouseMult||1},a.off=function(e){r.splice(e,1),t=r.length,0>=t&&Y()};var y=function(e){x.x+=x.deltaX,x.y+=x.deltaY,x.originalEvent=e;for(var n=0;t>n;n++)r[n](x)},E=function(e){x.deltaX=e.wheelDeltaY||-1*e.deltaY,x.deltaY=e.wheelDeltaX||-1*e.deltaX,p&&1===e.deltaMode&&(x.deltaX*=u,x.deltaY*=u),x.deltaX*=d,x.deltaY*=d,e.preventDefault(),y(e)},T=function(e){x.deltaX=e.wheelDeltaY?e.wheelDeltaY:e.wheelDelta,x.deltaY=e.wheelDeltaX?e.wheelDeltaX:0,y(e)},X=function(e){var t=e.targetTouches?e.targetTouches[0]:e;n=t.pageX,o=t.pageY},M=function(e){var t=e.targetTouches?e.targetTouches[0]:e;x.deltaX=(t.pageX-n)*l,x.deltaY=(t.pageY-o)*l,n=t.pageX,o=t.pageY,y(e)},A=function(e){switch(x.deltaX=x.deltaY=0,e.keyCode){case 37:x.deltaX=c;break;case 39:x.deltaX=-c;break;case 38:x.deltaY=c;break;case 40:x.deltaY=-c}y(e)},L=function(){f&&e.addEventListener("wheel",E),h&&e.addEventListener("mousewheel",T),m&&(e.addEventListener("touchstart",X),e.addEventListener("touchmove",M)),v&&w&&(i=e.body.style.msTouchAction,e.body.style.msTouchAction="none",e.addEventListener("MSPointerDown",X,!0),e.addEventListener("MSPointerMove",M,!0)),g&&e.addEventListener("keydown",A),s=!0},Y=function(){f&&e.removeEventListener("wheel",E),h&&e.removeEventListener("mousewheel",T),m&&(e.removeEventListener("touchstart",X),e.removeEventListener("touchmove",M)),v&&w&&(e.body.style.msTouchAction=i,e.removeEventListener("MSPointerDown",X,!0),e.removeEventListener("MSPointerMove",M,!0)),g&&e.removeEventListener("keydown",A),s=!1};return a}(document);return"undefined"!=typeof exports?("undefined"!=typeof module&&module.exports&&(exports=module.exports=i),exports.Parallaxer=i):"undefined"!=typeof define&&define.amd?define("Parallaxer",function(){return root.Parallaxer=i}()):window.Parallaxer=i,i}).call(this);